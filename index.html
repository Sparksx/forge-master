<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Forge Master</title>
</head>

<body>
    <!-- Auth Screen (shown before login) -->
    <div class="auth-screen" id="auth-screen">
        <div class="auth-container">
            <h1 class="auth-title">Forge Master</h1>
            <p class="auth-subtitle">Login or create an account to play</p>

            <!-- Login Form -->
            <form class="auth-form" id="login-form">
                <input type="text" id="login-username" placeholder="Username or Email" required autocomplete="username">
                <input type="password" id="login-password" placeholder="Password" required autocomplete="current-password">
                <div class="auth-error" id="login-error"></div>
                <button type="submit" class="auth-btn">Login</button>
                <p class="auth-switch">No account? <a href="#" id="show-register">Register</a></p>
            </form>

            <!-- Register Form (hidden by default) -->
            <form class="auth-form hidden" id="register-form">
                <input type="text" id="register-username" placeholder="Username" required minlength="3" maxlength="30" autocomplete="username">
                <input type="email" id="register-email" placeholder="Email" required autocomplete="email">
                <input type="password" id="register-password" placeholder="Password (6+ characters)" required minlength="6" autocomplete="new-password">
                <div class="auth-error" id="register-error"></div>
                <button type="submit" class="auth-btn">Register</button>
                <p class="auth-switch">Already have an account? <a href="#" id="show-login">Login</a></p>
            </form>
        </div>
    </div>

    <!-- Game Container (hidden until authenticated) -->
    <div class="hidden" id="game-container">
        <!-- Persistent Header (always visible, even over modals) -->
        <div class="app-header" id="app-header">
            <div class="header-row">
                <button class="header-btn" id="profile-btn">üë§</button>
                <div class="header-power" id="header-power">
                    <span class="header-power-icon">üî•</span>
                    <span class="header-power-value" id="header-power-value">110</span>
                </div>
                <div class="gold-display" id="gold-display">
                    <span class="gold-icon">üí∞</span>
                    <span class="gold-value" id="gold-amount">0</span>
                    <button class="gold-add-btn" id="gold-add-btn">+</button>
                </div>
            </div>
        </div>

        <!-- Tab Views -->
        <div class="tab-view" id="view-pvp">
            <div class="container">
                <h1>PvP Arena</h1>
                <div class="pvp-error" id="pvp-error"></div>

                <!-- Idle: Find Match -->
                <div class="pvp-section" id="pvp-idle-section">
                    <div class="pvp-idle-content">
                        <p>Challenge other players in real-time combat!</p>
                        <button class="pvp-btn pvp-queue-btn" id="pvp-queue-btn">Find Match</button>
                    </div>
                </div>

                <!-- Queue: Waiting -->
                <div class="pvp-section hidden" id="pvp-queue-section">
                    <div class="pvp-queue-content">
                        <div class="pvp-spinner"></div>
                        <p>Searching for opponent...</p>
                        <button class="pvp-btn pvp-cancel-btn" id="pvp-cancel-btn">Cancel</button>
                    </div>
                </div>

                <!-- Fight: Arena -->
                <div class="pvp-section hidden" id="pvp-fight-section">
                    <div class="pvp-arena">
                        <div class="pvp-fighter pvp-you">
                            <div class="pvp-fighter-label">You</div>
                            <div class="hp-bar-container">
                                <div class="hp-bar hp-bar-player" id="pvp-your-hp"></div>
                                <span class="hp-text" id="pvp-your-hp-text"></span>
                            </div>
                        </div>
                        <div class="pvp-vs">VS</div>
                        <div class="pvp-fighter pvp-opponent">
                            <div class="pvp-fighter-label" id="pvp-opponent-name">Opponent</div>
                            <div class="pvp-fighter-rating" id="pvp-opponent-rating"></div>
                            <div class="hp-bar-container">
                                <div class="hp-bar hp-bar-monster" id="pvp-opponent-hp"></div>
                                <span class="hp-text" id="pvp-opponent-hp-text"></span>
                            </div>
                        </div>
                    </div>

                    <div class="pvp-turn-info">
                        <span id="pvp-turn-timer">15s</span>
                    </div>

                    <div class="pvp-actions">
                        <button class="pvp-action-btn" data-action="attack">Attack</button>
                        <button class="pvp-action-btn" data-action="defend">Defend</button>
                        <button class="pvp-action-btn" data-action="special">Special</button>
                    </div>

                    <div class="pvp-combat-log" id="pvp-combat-log"></div>
                </div>

                <!-- Result -->
                <div class="pvp-section hidden" id="pvp-result-section">
                    <div class="pvp-result-content">
                        <h2 class="pvp-result-title" id="pvp-result-title">Victory!</h2>
                        <div class="pvp-rating-change" id="pvp-rating-change"></div>
                        <button class="pvp-btn" id="pvp-back-btn">Back to Lobby</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-view" id="view-dungeon">
            <div class="container">
                <h1>Dungeon</h1>
                <div class="placeholder-content">
                    <p>Coming soon...</p>
                </div>
            </div>
        </div>

        <div class="tab-view active" id="view-home">
            <!-- Top Half: Combat Zone -->
            <div class="combat-zone" id="combat-zone">
                <!-- Wave indicator -->
                <div class="wave-indicator">
                    <span class="wave-label" id="wave-label">Wave 1-1</span>
                    <div class="wave-progress-bar">
                        <div class="wave-progress-fill" id="wave-progress-fill"></div>
                    </div>
                </div>

                <!-- Combat Arena -->
                <div class="combat-arena">
                    <!-- Player Side -->
                    <div class="combatant combatant-player" id="combatant-player">
                        <div class="combatant-emoji" id="player-emoji">üßô</div>
                        <div class="combatant-name">You</div>
                        <div class="hp-bar-container">
                            <div class="hp-bar hp-bar-player" id="player-hp-bar"></div>
                            <span class="hp-text" id="player-hp-text">100 / 100</span>
                        </div>
                        <div class="damage-numbers damage-numbers-player" id="damage-numbers-player"></div>
                    </div>

                    <!-- VS indicator -->
                    <div class="combat-vs">
                        <span class="vs-text">‚öîÔ∏è</span>
                    </div>

                    <!-- Monster Side (dynamically populated) -->
                    <div class="monsters-side" id="monsters-side"></div>
                </div>

                <!-- Combat result overlay -->
                <div class="combat-result" id="combat-result"></div>
            </div>

            <!-- Bottom Half: Equipment & Forge -->
            <div class="forge-zone" id="forge-zone">

                <!-- Equipment Display (compact) -->
                <div class="equipment-display">
                    <div class="body-container">
                        <div class="equipment-slot" data-type="hat">
                            <div class="slot-icon">üé©</div>
                            <div class="slot-content" id="slot-hat">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="necklace">
                            <div class="slot-icon">üìø</div>
                            <div class="slot-content" id="slot-necklace">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="armor">
                            <div class="slot-icon">üõ°Ô∏è</div>
                            <div class="slot-content" id="slot-armor">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="weapon">
                            <div class="slot-icon">‚öîÔ∏è</div>
                            <div class="slot-content" id="slot-weapon">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="gloves">
                            <div class="slot-icon">üß§</div>
                            <div class="slot-content" id="slot-gloves">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="ring">
                            <div class="slot-icon">üíç</div>
                            <div class="slot-content" id="slot-ring">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="belt">
                            <div class="slot-icon">üìø</div>
                            <div class="slot-content" id="slot-belt">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>

                        <div class="equipment-slot" data-type="boots">
                            <div class="slot-icon">üë¢</div>
                            <div class="slot-content" id="slot-boots">
                                <span class="empty-slot">Empty</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Row -->
                <div class="action-row">
                    <button class="forge-btn" id="forge-btn">‚öíÔ∏è Forge</button>
                    <button class="action-icon-btn forge-level-btn" id="forge-upgrade-btn" title="Forge Upgrade">
                        <span class="forge-btn-level" id="forge-level">1</span>
                    </button>
                    <button class="action-icon-btn" id="auto-action-btn" title="Auto Forge">ü§ñ</button>
                </div>

                <!-- Chat Preview (2 lines, click to open full chat) -->
                <div class="chat-preview" id="chat-preview">
                    <div class="chat-preview-label">üí¨ Chat</div>
                    <div class="chat-preview-messages" id="chat-preview-messages">
                        <div class="chat-preview-empty">No messages yet</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-view" id="view-upgrade">
            <div class="container">
                <h1>‚¨ÜÔ∏è Upgrade</h1>
                <div class="sub-tab-nav" id="upgrade-sub-nav">
                    <button class="sub-tab active" data-subtab="skills">‚ö° Skills</button>
                    <button class="sub-tab" data-subtab="pets">üêæ Pets</button>
                    <button class="sub-tab" data-subtab="techs">üîß Techs</button>
                </div>
                <div class="sub-tab-content active" id="subtab-skills">
                    <div class="placeholder-content"><p>Skills coming soon...</p></div>
                </div>
                <div class="sub-tab-content" id="subtab-pets">
                    <div class="placeholder-content"><p>Pets coming soon...</p></div>
                </div>
                <div class="sub-tab-content" id="subtab-techs">
                    <div class="placeholder-content"><p>Techs coming soon...</p></div>
                </div>
            </div>
        </div>

        <div class="tab-view" id="view-shop">
            <div class="container">
                <h1>üõí Shop</h1>
                <p class="shop-subtitle">Buy gold to progress faster!</p>
                <div class="shop-offers" id="shop-offers">
                    <div class="shop-card" data-offer="pouch">
                        <div class="shop-card-icon">üëõ</div>
                        <div class="shop-card-name">Pouch of Gold</div>
                        <div class="shop-card-gold">üí∞ 100</div>
                        <button class="shop-card-btn">0.99$</button>
                    </div>
                    <div class="shop-card" data-offer="chest">
                        <div class="shop-card-icon">üì¶</div>
                        <div class="shop-card-name">Chest of Gold</div>
                        <div class="shop-card-gold">üí∞ 500</div>
                        <button class="shop-card-btn">4.99$</button>
                    </div>
                    <div class="shop-card" data-offer="treasury">
                        <div class="shop-card-icon">üè¶</div>
                        <div class="shop-card-name">Treasury</div>
                        <div class="shop-card-gold">üí∞ 2,000</div>
                        <button class="shop-card-btn">14.99$</button>
                    </div>
                    <div class="shop-card" data-offer="hoard">
                        <div class="shop-card-icon">üêâ</div>
                        <div class="shop-card-name">Dragon Hoard</div>
                        <div class="shop-card-gold">üí∞ 10,000</div>
                        <button class="shop-card-btn">49.99$</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav" id="bottom-nav">
            <button class="nav-tab" data-tab="pvp">
                <span class="nav-icon">‚öîÔ∏è</span>
                <span class="nav-label">PvP</span>
            </button>
            <button class="nav-tab" data-tab="dungeon">
                <span class="nav-icon">üè∞</span>
                <span class="nav-label">Dungeon</span>
            </button>
            <button class="nav-tab active" data-tab="home">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-tab" data-tab="upgrade">
                <span class="nav-icon">‚¨ÜÔ∏è</span>
                <span class="nav-label">Upgrade</span>
            </button>
            <button class="nav-tab" data-tab="shop">
                <span class="nav-icon">üõí</span>
                <span class="nav-label">Shop</span>
            </button>
        </nav>

        <!-- Full-page Chat Overlay -->
        <div class="chat-fullpage" id="chat-panel">
            <div class="chat-header">
                <span>üí¨ Chat</span>
                <button class="chat-close-btn" id="chat-close">‚úï</button>
            </div>
            <div class="chat-messages" id="chat-messages"></div>
            <div class="chat-input-row">
                <input type="text" class="chat-input" id="chat-input" placeholder="Type a message..." maxlength="500" autocomplete="off">
                <button class="chat-send-btn" id="chat-send">Send</button>
            </div>
        </div>

        <!-- Modal for Equip/Sell Decision -->
        <div class="modal" id="decision-modal">
            <div class="modal-content">
                <h2>New Equipment Forged!</h2>
                <div id="forged-item-info"></div>
            </div>
        </div>

        <!-- Modal for Item Details -->
        <div class="modal" id="item-detail-modal">
            <div class="modal-content">
                <h2>Equipment Details</h2>
                <div id="item-detail-info"></div>
                <div class="modal-buttons">
                    <button class="btn btn-equip" id="item-detail-close">Close</button>
                </div>
            </div>
        </div>

        <!-- Forge Upgrade Modal -->
        <div class="modal" id="forge-upgrade-modal">
            <div class="modal-content">
                <h2>‚öíÔ∏è Forge</h2>
                <div id="forge-upgrade-info"></div>
            </div>
        </div>

        <!-- Auto Forge Modal -->
        <div class="modal" id="auto-forge-modal">
            <div class="modal-content">
                <h2>ü§ñ Auto Forge</h2>
                <div id="auto-forge-info"></div>
            </div>
        </div>

        <!-- Profile Modal -->
        <div class="modal" id="profile-modal">
            <div class="modal-content">
                <h2>üë§ Profile</h2>
                <div id="profile-info"></div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script type="module" src="src/main.js"></script>
</body>

</html>
